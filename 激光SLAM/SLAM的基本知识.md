 SLAM(Simultaneous Localization and Mapping)，即同时的定位和建图。
 
 ### 一个经典的SLAM框架包括

1、传感器信息读取：读取运动底盘硬件传感器的数据以及预处理
2、前端里程计：估算相邻位姿之间的运动，以及局部地图的样子
3、后端优化：后端接收不同时刻里程计测量的位姿以及回环检测的信息，并处理优化得到地图
4、回环检测：回环检测判断机器人是否到达过先前的位置，检测到回环，会把信息提供给后端进行处理。
5、建图：根据估计轨迹，建立与任务要求对应的地图

### SLAM方向

#### 硬件传感器

##### 安置在环境中的：比如导轨、二维码标志
##### 携带在机器人本体上的： 轮式编码器、相机、激光传感器、定位模块

这些传感器都约束了外部环境，只有约束满足（例如看到二维码标志和激光传感器受到信息）定位工作才能正常进行。

##### 单目相机

只用一个相机来进行视觉SLAM，结构简单成本低。

照片本质上是以二维的形式展示三维世界，这种展示方式会缺少一种信息，远近。我们人类所产生的远近感是我们接受了大量的照片的训练得到的，但是计算机还不行，那么在视觉SLAM中，多张图片组成了运动，我们不难意识到，在画面中，离我们近的运动得快，离我们远的运动地慢。但是这不够，因为我们不知道近的离我们有多近，离我们远的有多远，我们缺少了一个标准的尺度。

##### 双目相机

双目相机由两个单目相机组合而成，两个相机之间的距离成为基线(Baseline)，我们通过基线来判定每个像素的空间位置（例如获得同一个像素在相机A的位置和相机B的位置，然后再通过三角测算法来得出距离）

但是双目相机需要很高的算力，而且基线距离越大，测量的距离越远（因为物体在距离双目相机到一个距离的时候，视差的信息就不可知了（因为角度过小））会增加体型，同时受分辨率的影响大。

##### 深度相机

主要是通过红外结构光或者ToF法，主动向物体发射光并且接收返回的光。通过物理手段的测量可以减少大量的计算量，并且受环境限制很大，一般只有在室内可以使用。


#### 视觉里程计

视觉里程计关注相邻图像中相机发生的运动，通过相邻帧之间的图像估计相机的运动，并且或者场景的空间结构。不过仅通过视觉里程计来估计空间，就会不可避免地出现累积漂移，因为两次估计中不可避免地会出现误差，而且里程计会不可避免地把误差传达到下一个时刻，然后逐渐叠加漂移。
需要解决漂移问题，就需要后端优化和回环检测。

补充知识：

视觉里程计的工作方式：

  图像采集和特征提取：通过摄像头连续采集图像序列，然后进行特征提取，提取特征点，例如边缘还有角，常用的特征提取方法有（SIFT,SURF,ORB）。

  特征匹配和运动估计：将当前帧的图像中的特征和前一帧和多帧图像中的特征进行匹配，找到相同特征点的对应关系。通过几何模型算法（如PnP和光流法），估算相机在相邻帧之间的相对运动。光流法），估算相机在相邻帧之间的相对运动。

  轨迹重建与优化：不断积累相邻帧之间的相对运动，可以重建出相机和移动平台的运动轨迹，可以通过一些滤波和优化算法，例如卡尔曼滤波和非线性优化，对运动估计的结果进行平滑和优化。

惯性里程计（激光SLAM会用）工作方式：

惯性传感器数据采集：通过安装在移动平台上的惯性测量单元（IMU），测量物体在运动过程中的加速度和角速度等惯性信息，通过三轴加速度计和三轴陀螺仪提供运动数据。

积分计算和位置更新：通过初始时刻的位置和姿态作为参考，对加速度和角速度数据进行积分运算，得到物体在不同时刻的速度位置和姿态信息，惯性测量数据存在累积误差，所以需要定期对数据进行矫正，提高位置估计的准确性。

#### 后端优化

后端优化主要是解决SLAM过程中的噪声的问题。那什么是噪声？噪声是传感器输出信号中和测量无关，且无规则的随机变化成分（例如相片中的我们一直提到的噪点）。再精确的传感器也不可避免地会出现噪声，噪声体现在两个方面：内部环境（温度对电子运动的变化）和外部环境（电磁干扰）。
后端优化要从带有噪声的数据中估计整个系统的状态，和这个状态估计的不确定性有多大，这被称为最大后验概率估计（Maximum-a-Posteriori,MAP），这里既包含机器人的自身轨迹，也包含地图。

#### 回环检测（闭环检测）

回环检测主要解决位置估计随时间漂移的问题。假设机器人经过一段时间回到了原点，但是由于漂移，位置估计值却没有回到原点，那么为我们可以通过某种方法让它知道他回到了原点，以此来消除漂移。例如我们可以通过判断图像间的相似性来完成回环检测。

#### 建图

建图的话主要分为度量地图和拓扑地图。度量地图强调精确表示地图中物体的位置关系，拓扑地图主要强调物体之间相互的位置关系。度量地图分成了稀疏图和稠密图。稀疏图选择了一部分具有代表意义的东西，即路标。







### SLAM 的数学表示

$$
x_k=f(x_k-1 ,u_k,w_k)
$$
$$
z_{k,j} = h(y_j,x_k,v_{k,j})
$$
第一条式子是当前的位置的判断 $u_k$是当前传感器输入的数据$w_k$是噪声
第二条式子是当前识别的物体的位置的判断
这两条方程描述了**最基本的SLAM问题**，当知道运动测量的读数$u$，以及传感器的读书$z$，如何求解定位问题（估计$x$）和建图问题（估计$y$），即状态估计问题。

对于状态估计问题的求解，要看两个方程的具体形式还有噪声服从哪种分布有关。按照这两个方程线性/非线性，噪声是否符合高斯分布分类，分为线性和非线性和高斯/非高斯系统。

线性高斯系统（Linear Gaussian,LG系统）的无偏最优估计可以由卡尔曼滤波（KF）得出。

非线性非高斯系统 (Non-Linear Non-Gaussian , NLNG系统)我们可以用扩展卡尔曼滤波（EKF）和非线性优化两大类方法去求解。
而21世纪早期，EKF为主要的方法，在工作点处把系统线性化，以预测-更新两大步骤求解。
但EKF存在以下缺点（线性化误差和噪声高斯分布假设），然后有在用粒子滤波器或者非线性优化来求解，现在也有以图优化(Graph Optimization)的优化方法。（其实只要算力足够，看起来使用优化方法效果好）。

补充：三维世界的运动可以看作是六个自由度（三个轴的平移，三个轴的旋转）（位姿）



一些宝宝解释：
线性/非线性：最简单的说，线性的系统就是各个因素的影响只是叠加的，非线性的系统可能一个微小的因素变化都会带来巨大的幅值变化。
高斯分布：其实就是正态分布